knitr::opts_chunk$set(echo = TRUE)
# install.packages('comprehenr')
# install.packages('dplyr')
library(comprehenr)
library(KernSmooth)
library(ellipse)
library(MVA)
library(CCA)
library(dplyr)
# comment
full_df = read.csv('https://raw.githubusercontent.com/iniadewumi/MVA-Dataset-Exploration/master/MVA/datasets/leaf/leaf.csv')
k = c("1" = "Quercus suber", "2" = "Salix atrocinerea", "3" = "Populus nigra", "4" = "Alnus sp",
"5" = "Quercus robur", "6" = "Crataegus monogyna", "7" = "Ilex aquifolium", "8" = "Nerium oleander",
"9" = "Betula pubescens", "10" = "Tilia tomentosa", "11" = "Acer palmaturu", "12" = "Celtis sp",
"13" = "Corylus avellana", "14" = "Castanea sativa", "15" = "Populus alba", "16" = "Acer negundo",
"17" = "Taxus bacatta", "18" = "Papaver sp", "19" = "Polypodium vulgare", "20" = "Pinus sp",
"21" = "Fraxinus sp", "22" = "Primula vulgaris", "23" = "Erodium sp", "24" = "Bougainvillea sp",
"25" = "Arisarum vulgare", "26" = "Euonymus japonicus", "27" = "Ilex perado ssp azorica",
"28" = "Magnolia soulangeana", "29" = "Buxus sempervirens", "30" = "Urtica dioica",
"31" = "Podocarpus sp", "32" = "Acca sellowiana", "33" = "Hydrangea sp", "34" = "Pseudosasa japonica",
"35" = "Magnolia grandiflora", "36" = "Geranium sp", "37" = "Aesculus californica",
"38" = "Chelidonium majus", "39" = "Schinus terebinthifolius", "40" = "Fragaria vesca")
cols = c('Class', 'Specimen_Number', 'Eccentricity', 'Aspect_Ratio', 'Elongation', 'Solidity',
'Stochastic_Convexity', 'Isoperimetric_Factor', 'Maximal_Indentation_Depth', 'Lobedness',
'Average_Intensity', 'Average_Contrast', 'Smoothness', 'Third_Moment', 'Uniformity',
'Entropy')
colnames(full_df) = cols
for (i in 1:nrow(full_df)) {
name = as.character(k[full_df[i, "Class"]])
full_df[i, "Sci_Name"] = name
}
outliers <- function(x) {
Q1 <- quantile(x, probs=.25)
Q3 <- quantile(x, probs=.75)
iqr = Q3-Q1
upper_limit = Q3 + (iqr*1.5)
lower_limit = Q1 - (iqr*1.5)
x > upper_limit | x < lower_limit
}
remove_outliers <- function(df, cols = names(df)) {
for (col in cols) {
df <- df[!outliers(df[[col]]),]
}
df
}
test = full_df %>% group_split(Sci_Name)
for(i in 1:length(test)){
df = test[[i]]
out_df = remove_outliers(df, as.vector(colnames(df)))
}
## Single linkage hierarchical clustering
hcs <- hclust(leaf.dist, "single")
plot(hcs, main = "Single Linkage HC Dendrogram")
plot(rev(hcs$height))
ct <- cutree(hcs, 12)
## Single linkage hierarchical clustering
hcs <- hclust(leaf.dist, "single")
leaf_df.cor = cor(leaf_df)
leaf_df.cov = cov(leaf_df)
cat("Covariance Matrix\n\n")
leaf_df.cov
cat("\n\nCorrelation Matrix\n\n")
leaf_df.cor
for(i in 1:length(test)){
df = test[[i]]
out_df = remove_outliers(df, as.vector(colnames(df)))
}
remove_outliers <- function(df, cols = names(df)) {
for (col in cols) {
df <- df[!outliers(df[[col]]),]
}
df
}
test = full_df %>% group_split(Sci_Name)
for(i in 1:length(test)){
df = test[[i]]
out_df = remove_outliers(df, as.vector(colnames(df)))
}
